<div class="absensi-box">
    <div class="table-header">
        <span>NAMA SANTRI</span>
        <span>STATUS</span>
    </div>
    
    <div id="list-santri">
        </div>

    <button class="btn-dark-sm" style="width: 100%; margin-top: 15px; border: 1px dashed var(--madin-green); background: none; color: var(--madin-green);" onclick="tambahSantri()">
        + TAMBAH NAMA SANTRI
    </button>

    <button class="btn-konfirmasi" onclick="simpanKeDatabase()">KONFIRMASI</button>
</div>

<script>
    let dataSantri = [
        { id: 101, nama: "ZAYDAN", status: "" },
        { id: 102, nama: "SYAMIL", status: "" }
    ];

    function renderSantri() {
        const container = document.getElementById('list-santri');
        container.innerHTML = dataSantri.map(s => `
            <div class="santri-item">
                <div class="d-flex align-items-center gap-2">
                    <button class="name-btn" onclick="editNama(${s.id})">${s.nama}</button>
                </div>
                <div class="status-options">
                    <button class="btn-st ${s.status==='H'?'active':''}" onclick="updateStatus(${s.id},'H')">H</button>
                    <button class="btn-st ${s.status==='S'?'active':''}" onclick="updateStatus(${s.id},'S')">S</button>
                    <button class="btn-st ${s.status==='I'?'active':''}" onclick="updateStatus(${s.id},'I')">I</button>
                    <button class="btn-st ${s.status==='A'?'active':''}" onclick="updateStatus(${s.id},'A')">A</button>
                    <button onclick="hapusSantri(${s.id})" style="background:none; border:none; color:#ff5252; font-size:1.2rem; padding:0 5px;">&times;</button>
                </div>
            </div>
        `).join('');
    }

    // --- FITUR BARU ---
    
    // 1. TAMBAH SANTRI
    function tambahSantri() {
        const namaBaru = prompt("Masukkan Nama Santri Baru:");
        if (namaBaru && namaBaru.trim() !== "") {
            const idBaru = Date.now(); // Generate ID unik
            dataSantri.push({ id: idBaru, nama: namaBaru.toUpperCase(), status: "" });
            renderSantri();
            // Nanti di sini panggil google.script.run.addNewSantriToSheet(namaBaru)
        }
    }

    // 2. HAPUS SANTRI
    function hapusSantri(id) {
        const santri = dataSantri.find(x => x.id === id);
        if (confirm(`Yakin ingin menghapus santri: ${santri.nama}?`)) {
            dataSantri = dataSantri.filter(x => x.id !== id);
            renderSantri();
            // Nanti di sini panggil google.script.run.deleteSantriFromSheet(id)
        }
    }

    // 3. EDIT NAMA (Sudah Ada)
    function editNama(id) {
        const s = dataSantri.find(x => x.id === id);
        const namaEdit = prompt("Edit Nama Santri:", s.nama);
        if (namaEdit && namaEdit.trim() !== "") {
            s.nama = namaEdit.toUpperCase();
            renderSantri();
            // Nanti di sini panggil google.script.run.updateSantriNameInSheet(id, namaEdit)
        }
    }

    // Sisanya (updateStatus, simpanKeDatabase) tetap sama...
    function updateStatus(id, stat) {
        const santri = dataSantri.find(x => x.id === id);
        santri.status = stat;
        renderSantri();
    }

    function simpanKeDatabase() {
        const tgl = document.getElementById('input-tanggal').value;
        alert("Data Tanggal " + tgl + " Berhasil Dikonfirmasi!");
    }

    window.onload = () => {
        renderSantri();
    };
</script>
